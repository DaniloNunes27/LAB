<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Jogo de Falhas Bizantinas</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      background: #f0f0f0;
      padding: 20px;
    }
    h1 {
      color: #333;
    }
    .node {
      display: inline-block;
      margin: 10px;
      padding: 10px;
      border: 2px solid #333;
      border-radius: 10px;
      width: 120px;
      background-color: #fff;
    }
    .traitor {
      background-color: #ffcccc;
    }
    .loyal {
      background-color: #ccffcc;
    }
  </style>
</head>
<body>
  <h1>Jogo de Detecção de Falhas Bizantinas</h1>

  <label for="nodeCount">Número de nós: </label>
  <input type="number" id="nodeCount" value="5" min="3" max="10"><br><br>

  <label for="traitorCount">Número de traidores: </label>
  <input type="number" id="traitorCount" value="1" min="0" max="3"><br><br>

  <label for="command">Comando do comandante: </label>
  <select id="command">
    <option value="ATACAR">ATACAR</option>
    <option value="RECUAR">RECUAR</option>
  </select><br><br>

  <button onclick="startSimulation()">Simular</button>

  <h2>Resultado:</h2>
  <div id="result"></div>

  <script>
    function startSimulation() {
      const nodeCount = parseInt(document.getElementById('nodeCount').value);
      const traitorCount = parseInt(document.getElementById('traitorCount').value);
      const command = document.getElementById('command').value;

      if (traitorCount >= nodeCount / 3) {
        alert("⚠️ Para garantir consenso bizantino, o número de traidores deve ser menor que 1/3 dos nós.");
        return;
      }

      const resultDiv = document.getElementById('result');
      resultDiv.innerHTML = '';

      const nodes = [];
      const traitorIndexes = new Set();

      // Marcar nós traidores
      while (traitorIndexes.size < traitorCount) {
        traitorIndexes.add(Math.floor(Math.random() * nodeCount));
      }

      for (let i = 0; i < nodeCount; i++) {
        const isTraitor = traitorIndexes.has(i);
        const decision = isTraitor
          ? (Math.random() > 0.5 ? "ATACAR" : "RECUAR")
          : command;

        nodes.push({ id: i + 1, isTraitor, decision });
      }

      // Mostrar decisões
      const decisions = {};
      nodes.forEach(node => {
        const div = document.createElement('div');
        div.className = `node ${node.isTraitor ? 'traitor' : 'loyal'}`;
        div.innerHTML = `<strong>Nó ${node.id}</strong><br>${node.isTraitor ? 'Traidor' : 'Leal'}<br>Decisão: ${node.decision}`;
        resultDiv.appendChild(div);

        decisions[node.decision] = (decisions[node.decision] || 0) + 1;
      });

      // Decisão final por maioria
      const finalDecision = decisions.ATACAR > decisions.RECUAR ? "ATACAR" : "RECUAR";
      const summary = document.createElement('p');
      summary.innerHTML = `<br><strong>Decisão Final por Maioria: ${finalDecision}</strong>`;
      resultDiv.appendChild(summary);
    }
  </script>
</body>
</html>
